// form-data-json-convert | version: 2.0.0beta | url: https://brainfoolong.github.io/form-data-json/example/playground.html
'use strict';function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classStaticPrivateFieldSpecGet(a,b,c){return _classCheckPrivateStaticAccess(a,b),_classCheckPrivateStaticFieldDescriptor(c,"get"),_classApplyDescriptorGet(a,c)}function _classCheckPrivateStaticFieldDescriptor(a,b){if(a===void 0)throw new TypeError("attempted to "+b+" private static field before its declaration")}function _classApplyDescriptorGet(a,b){return b.get?b.get.call(a):b.value}function _classStaticPrivateMethodGet(a,b,c){return _classCheckPrivateStaticAccess(a,b),c}function _classCheckPrivateStaticAccess(a,b){if(a!==b)throw new TypeError("Private static access of wrong provenance")}var FormDataJson=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"toJson",value:function toJson(b,c){function d(b,c){if("function"!=typeof c.inputFilter&&!0!==c.inputFilter(b))return!1;if(!c.includeDisabled&&b.disabled)return!1;var d=(b.type||"text").toLowerCase();return!(!c.includeButtonValues&&(b instanceof HTMLButtonElement||-1<_classStaticPrivateFieldSpecGet(a,a,_buttonInputTypes).indexOf(d)))&&!!(c.includeUncheckedAsNull||!(-1<_classStaticPrivateFieldSpecGet(a,a,_checkedInputTypes).indexOf(d))||b.checked)}function e(a,b){for(var o in a){var f=a[o],g=c.flatList?f.name:o;if("nested"===f.type){c.flatList?e(f.tree,b):(b[o]={},e(f.tree,b[o]));continue}var p=f.input;if("default"!==f.type||d(p,c)){var j=f.inputType;if("file"===j){c.filesCallback&&h.push({object:b,key:g,input:p});continue}var k=null;if("radio"===f.type){for(var q,r=0;r<f.inputs.length;r++)if(q=f.inputs[r],d(q,c)&&q.checked){k=q.value;break}}else if("checkbox"===j)k=p.checked?p.value:null;else if(p instanceof HTMLSelectElement){for(var l,m=[],n=0;n<p.options.length;n++)l=p.options[n],l.selected&&m.push(("undefined"==typeof l.value?l.text:l.value).toString());k=p.multiple?m:m.length?m[0]:null}else k=p.value;b[g]=k}}}c=Object.assign({},a.defaultOptionsToJson,c||{});var f=_classStaticPrivateMethodGet(a,a,_getFieldTree).call(a,b,c),g={},h=[];return e(f,g),h.length?function(){for(var b=0,d=0,e=function(e){var f=h[e],i=f.object;d+=f.input.files.length;for(var k=function(e){var h=f.input.files[e],j=new FileReader;j.onload=function(){f.input.multiple?(!_classStaticPrivateMethodGet(a,a,_isArray).call(a,i[f.key])&&(i[f.key]=[]),i[f.key].push(j.result)):i[f.key]=j.result,b++,b===d&&c.filesCallback(_classStaticPrivateMethodGet(a,a,_arrayfy).call(a,g))},j[c.fileReaderFunction](h)},l=0;l<f.input.files.length;l++)k(l)},f=0;f<h.length;f++)e(f)}():c.filesCallback&&c.filesCallback(_classStaticPrivateMethodGet(a,a,_arrayfy).call(a,g)),_classStaticPrivateMethodGet(a,a,_arrayfy).call(a,g)}},{key:"fromJson",value:function fromJson(b,c,d){function e(b,c){for(var h in b){var f=b[h],g=d.flatList?f.name:h;if("nested"===f.type){d.flatList?e(f.tree,c):"object"===_typeof(c[g])&&e(f.tree,c[g]);continue}(d.clearOthers||"undefined"!=typeof c[g])&&_classStaticPrivateMethodGet(a,a,_setInputValue).call(a,f,c[g]||null)}}if(_classStaticPrivateMethodGet(a,a,_isObject).call(a,c)){d=Object.assign({},a.defaultOptionsFromJson,d||{});var f=_classStaticPrivateMethodGet(a,a,_getFieldTree).call(a,b,d);e(f,c)}}},{key:"reset",value:function reset(b){var c=_classStaticPrivateMethodGet(a,a,_getFieldTree).call(a,b);if(c)for(var j in c){var d=c[j],e=d.input;if(!(e.type&&-1<_classStaticPrivateFieldSpecGet(a,a,_buttonInputTypes).indexOf(e.type.toLowerCase())))if(e.type&&-1<_classStaticPrivateFieldSpecGet(a,a,_checkedInputTypes).indexOf(e.type.toLowerCase()))e.checked=e.defaultChecked;else if(e instanceof HTMLSelectElement)for(var f,g=e.querySelectorAll("option"),h=0;h<g.length;h++)f=g[h],f.selected=f.defaultSelected;else e.getAttribute("value")?e.value=e.getAttribute("value"):("string"==typeof e.defaultValue||"number"==typeof e.defaultValue)&&(e.value=e.defaultValue)}}},{key:"clear",value:function clear(b){var c=_classStaticPrivateMethodGet(a,a,_getFieldTree).call(a,b);if(c)for(var f in c){var d=c[f],e=d.input;e.type&&-1<_classStaticPrivateFieldSpecGet(a,a,_buttonInputTypes).indexOf(e.type.toLowerCase())||_classStaticPrivateMethodGet(a,a,_setInputValue).call(a,e,null)}}}]),a}();function _arrayfy(a){if(_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_isObject).call(FormDataJson,a)){var b=0,c=!0;for(var d in a)_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_isObject).call(FormDataJson,a[d])&&!(a[d]instanceof Element)&&(a[d]=_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_arrayfy).call(FormDataJson,a[d])),parseInt(d)!==b&&(c=!1),b++;if(c)return Object.values(a)}return a}function _setInputValue(a,b){if("radio"===a.type){for(var g,h=0;h<a.inputs.length;h++)if(g=a.inputs[h],null!==b&&_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_stringify).call(FormDataJson,g.value)===_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_stringify).call(FormDataJson,b)){g.checked=!0;break}return}var c=a.input,d=a.inputType;if("file"!==d)if("checkbox"===d)c.checked=!0===b||null!==b&&_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_stringify).call(FormDataJson,c.value)===_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_stringify).call(FormDataJson,b);else if(c instanceof HTMLSelectElement){var i=b;null===i||void 0===i?i=[]:_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_isObject).call(FormDataJson,i)?i=Object.values(i):!_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_isArray).call(FormDataJson,i)&&(i=[i]);for(var k=0;k<c.options.length;k++){var e=c.options[k],f=("undefined"==typeof e.value?e.text:e.value).toString();e.selected=!1;for(var l=0;l<i.length;l++)if(f===_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_stringify).call(FormDataJson,i[l])){e.selected=!0;break}}}else c.value=b}function _stringify(a){return void 0===a?"":"object"===_typeof(a)?"":"boolean"==typeof a?a?"1":"0":a+""}function _getFieldTree(a){if(a=_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_getElement).call(FormDataJson,a),!a)return[];for(var b,c=a.querySelectorAll("select, textarea, input, button"),d={},e={},f=0;f<c.length;f++)if(b=c[f],b.name&&0!==b.name.length){var g=(b.type||"text").toLowerCase(),h=b.name,k=b.name.replace(/\]/g,"").split("[");h.endsWith("[]")&&(b instanceof HTMLSelectElement&&b.multiple?k.pop():"radio"===g&&k.pop());for(var l,m=k.length,n=d,o="",p=0;p<m;p++)l=k[p],o=o?o+"["+l+"]":l,""===l&&("undefined"==typeof e[o]&&(e[o]=0),l=e[o].toString(),e[o]++),m-1==p?"radio"===(b.type||"text").toLowerCase()?("undefined"==typeof n[l]&&(n[l]={type:"radio",name:b.name,inputType:g,inputs:[]}),n[l].inputs.push(b)):n[l]={type:"default",name:b.name,inputType:g,input:b}:(("undefined"==typeof n[l]||"undefined"==typeof n[l].tree)&&(n[l]={type:"nested",tree:{}}),n=n[l].tree)}return d}function _isObject(a){return a&&"object"===_typeof(a)&&"[object Array]"!==Object.prototype.toString.call(a)}function _isArray(a){return"object"===_typeof(a)&&"[object Array]"===Object.prototype.toString.call(a)}function _getElement(a){return"string"==typeof a?document.querySelector(a):a instanceof HTMLElement?a:"undefined"!=typeof jQuery&&a instanceof jQuery?a[0]:(console.warn("FormDataJson: Unsupported element passed. Supported is HTMLElement, a string query selector or JQuery object"),null)}_defineProperty(FormDataJson,"defaultOptionsToJson",{includeDisabled:!1,includeButtonValues:!1,includeUnchecked:!1,inputFilter:null,flatList:!1,filesCallback:null,fileReaderFunction:"readAsDataURL"}),_defineProperty(FormDataJson,"defaultOptionsFromJson",{flatList:!1,clearOthers:!1});var _buttonInputTypes={writable:!0,value:["button","submit","reset","image"]},_checkedInputTypes={writable:!0,value:["checkbox","radio"]};"undefined"!=typeof module&&module.exports&&(module.exports=FormDataJson);