// form-data-json-convert | version: 2.0.0beta | url: https://brainfoolong.github.io/form-data-json/example/playground.html
'use strict';function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classStaticPrivateFieldSpecGet(a,b,c){return _classCheckPrivateStaticAccess(a,b),_classCheckPrivateStaticFieldDescriptor(c,"get"),_classApplyDescriptorGet(a,c)}function _classCheckPrivateStaticFieldDescriptor(a,b){if(a===void 0)throw new TypeError("attempted to "+b+" private static field before its declaration")}function _classApplyDescriptorGet(a,b){return b.get?b.get.call(a):b.value}function _classStaticPrivateMethodGet(a,b,c){return _classCheckPrivateStaticAccess(a,b),c}function _classCheckPrivateStaticAccess(a,b){if(a!==b)throw new TypeError("Private static access of wrong provenance")}var FormDataJson=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"toJson",value:function toJson(b,c){var d=_classStaticPrivateMethodGet(a,a,_getFormElementsFlat).call(a,b);if(!d)return{};c=Object.assign({},a.defaultOptionsToJson,c||{});var e={},f=[];for(var q in d){var g=d[q],h=g.input;if(_classStaticPrivateMethodGet(a,a,_isElementAllowed).call(a,h,c)){var j=(h.type||"text").toLowerCase();if(c.includeDisabled||!h.disabled){if(!c.includeButtonValues&&(h instanceof HTMLButtonElement||-1<_classStaticPrivateFieldSpecGet(a,a,_buttonInputTypes).indexOf(j)))continue;for(var k,l=_classStaticPrivateMethodGet(a,a,_getInputValue).call(a,h),m=c.flatList?[h.name]:q.replace(/\]/g,"").split("["),n=e,o=m.length,p=0;p<o;p++)if(k=m[p],p==o-1){if("file"===j&&(c.filesCallback&&f.push({object:n,key:k,input:h}),l=null),!c.includeUncheckedAsNull&&-1<_classStaticPrivateFieldSpecGet(a,a,_checkedInputTypes).indexOf(j)&&null===l)continue;n[k]=l}else"array"!==g.type||_classStaticPrivateMethodGet(a,a,_isArray).call(a,n[k])?!_classStaticPrivateMethodGet(a,a,_isObject).call(a,n[k])&&(n[k]={}):n[k]=[],n=n[k]}}}return f.length?function(){for(var b=0,d=0,g=function(g){var h=f[g],i=h.object;d+=h.input.files.length;for(var k=function(f){var g=h.input.files[f],j=new FileReader;j.onload=function(){h.input.multiple?(!_classStaticPrivateMethodGet(a,a,_isArray).call(a,i[h.key])&&(i[h.key]=[]),i[h.key].push(j.result)):i[h.key]=j.result,b++,b===d&&c.filesCallback(e)},j[c.fileReaderFunction](g)},l=0;l<h.input.files.length;l++)k(l)},h=0;h<f.length;h++)g(h)}():c.filesCallback&&c.filesCallback(e),e}},{key:"fromJson",value:function fromJson(b){var c=_classStaticPrivateMethodGet(a,a,_getFormElementsFlat).call(a,b);if(!c)return{}}}]),a}();function _getInputValue(a){if(a instanceof HTMLSelectElement){for(var b,c=[],d=0;d<a.options.length;d++)b=a.options[d],b.selected&&c.push(("undefined"==typeof b.value?b.text:b.value).toString());return a.multiple?c:c.length?c[0]:null}return a instanceof HTMLInputElement&&-1<_classStaticPrivateFieldSpecGet(FormDataJson,FormDataJson,_checkedInputTypes).indexOf(a.type.toLowerCase())?a.checked?a.value:null:a.value}function _setInputValue(a,b){var c=(a.type||"text").toLowerCase();if(a instanceof HTMLInputElement&&-1<_classStaticPrivateFieldSpecGet(FormDataJson,FormDataJson,_checkedInputTypes).indexOf(c))a.checked=b===a.value;else if(a instanceof HTMLSelectElement){_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_isArray).call(FormDataJson,b)||(b=[b]);for(var f=0;f<b.length;f++)b[f]=null!==b[f]&&b[f]!==void 0?b[f]+"":b[f];for(var g=0;g<a.options.length;g++){var d=a.options[g],e="undefined"==typeof d.value?d.text:d.value;d.selected=-1<b.indexOf(e)}}else if(a instanceof HTMLInputElement&&"file"===c);else a.value=b}function _getFormElementsFlat(a){if(a=_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_getElement).call(FormDataJson,a),!a)return console.warn("FormDataJson: Unsupported element passed"),null;for(var b,c=a.querySelectorAll("select, textarea, input, button"),d={},e=0;e<c.length;e++)if(b=c[e],b.name&&0!==b.name.length){var f=b.name,g=f.replace(/\[\]$/g,""),h=b instanceof HTMLSelectElement&&b.multiple;h||g===f?h?d[g]=b:d[f]=b:(!_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_isArray).call(FormDataJson,d[g])&&(d[g]=[]),d[g].push(b))}var j={};for(var k in d){var l=d[k];if(_classStaticPrivateMethodGet(FormDataJson,FormDataJson,_isArray).call(FormDataJson,l))for(var m=0;m<l.length;m++)j[k+"["+m+"]"]={type:"array",input:l[m]};else j[k]={type:"default",input:l}}return j}function _isObject(a){return"object"===_typeof(a)&&"[object Array]"!==Object.prototype.toString.call(a)}function _isArray(a){return"object"===_typeof(a)&&"[object Array]"===Object.prototype.toString.call(a)}function _isElementAllowed(a,b){return"function"!=typeof b.inputFilter||!0===b.inputFilter(a)}function _getElement(a){return"string"==typeof a?document.querySelector(a):a instanceof HTMLElement?a:("undefined"!=typeof jQuery&&a instanceof jQuery&&(a=a[0]),null)}_defineProperty(FormDataJson,"defaultOptionsToJson",{includeDisabled:!1,includeButtonValues:!1,includeUnchecked:!1,inputFilter:null,flatList:!1,filesCallback:null,fileReaderFunction:"readAsDataURL"});var _buttonInputTypes={writable:!0,value:["button","submit","reset","image"]},_checkedInputTypes={writable:!0,value:["checkbox","radio"]};"undefined"!=typeof module&&module.exports&&(module.exports=FormDataJson);