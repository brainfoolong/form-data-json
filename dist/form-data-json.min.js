'use strict';
// form-data-json-convert | version: 2.1.3 | url: https://github.com/brainfoolong/form-data-json
var FormDataJson=function(){function a(){}return a.toJson=function toJson(b,c){function d(b){if("function"==typeof c.inputFilter&&!0!==c.inputFilter(b))return!1;if(!c.includeDisabled&&b.disabled)return!1;var d=(b.type||"text").toLowerCase();return!(!c.includeButtonValues&&(b instanceof HTMLButtonElement||-1<a.buttonInputTypes.indexOf(d)))&&("undefined"!=typeof c.uncheckedValue||!(-1<a.checkedInputTypes.indexOf(d))||b.checked)}function e(a,b){for(var n in a){var d=a[n],f=c.flatList?d.name:n;if("nested"===d.type){c.flatList?e(d.tree,b):(b[n]={},e(d.tree,b[n]));continue}var g=d.input,h=d.inputType;if("file"===h){c.filesCallback&&k.push({object:b,key:f,input:g});continue}var o=null;if("radio"===d.type){for(var p,q=0;q<d.inputs.length;q++)if(p=d.inputs[q],p.checked){o=p.value;break}null===o&&(o=c.uncheckedValue)}else if("checkbox"===h)o=g.checked?g.value:c.uncheckedValue;else if(g instanceof HTMLSelectElement){for(var j,l=[],m=0;m<g.options.length;m++)j=g.options[m],j.selected&&l.push(("undefined"==typeof j.value?j.text:j.value).toString());o=g.multiple?l:l.length?l[0]:null}else o=g.value;c.flatList?b.push([d.name,o]):b[f]=o}}function f(b){if(a.isObject(b)){var c=0,d=!0;for(var e in b)a.isObject(b[e])&&!(b[e]instanceof Element)&&(b[e]=f(b[e])),parseInt(e)!==c&&(d=!1),c++;if(d){var g=[];for(var h in b)g.push(b[h]);return g}}return b}function g(){return c.arrayify&&(j=f(j)),c.skipEmpty&&(j=h(j)||(c.flatList?[]:{})),j}function h(b,d){var e=a.isArray(b),f=e?[]:{},g=0;for(var i in b){var j=b[i];(c.flatList&&!d&&(j=j[1]),(a.isObject(j)||a.isArray(j))&&(j=h(j,(d||0)+1)||""),"object"==typeof j||""!==a.stringify(j))&&(e?f.push(c.flatList&&!d?[b[i][0],j]:j):f[i]=j,g++)}return g?f:null}c=a.merge(a.defaultOptionsToJson,c);var i=a.getFieldTree(b,d),j=c.flatList?[]:{},k=[];if(e(i,j),k.length){var l=function(){for(var b=0,d=0,e=function(e){var f=k[e],h=f.object;d+=f.input.files.length;for(var i=function(e){var i=f.input.files[e],j=new FileReader;j.onload=function(){f.input.multiple?(!a.isArray(h[f.key])&&(h[f.key]=[]),h[f.key].push(j.result)):h[f.key]=j.result,b++,b===d&&c.filesCallback(g())},j[c.fileReaderFunction](i)},l=0;l<f.input.files.length;l++)i(l)},f=0;f<k.length;f++)e(f);return{v:null}}();if("object"==typeof l)return l.v}else if(c.filesCallback)return c.filesCallback(g()),null;return g()},a.fromJson=function fromJson(b,c,d){function e(b,c){if(a.isObject(c)||a.isArray(c))for(var j in b){var f=b[j],h=d.flatList?f.name:j;if("nested"===f.type){d.flatList?e(f.tree,c):"object"==typeof c[h]&&e(f.tree,c[h]);continue}if(d.flatList){for(var k in c){var i=c[k];if(i&&i[0]===f.name&&g[f.name]!==k){g[f.name]=k,a.setInputValue(f,i[1],d.triggerChangeEvent);break}}continue}"undefined"!=typeof c[h]&&a.setInputValue(f,c[h]||null,d.triggerChangeEvent)}}if(a.isObject(c)||a.isArray(c)){d=a.merge(a.defaultOptionsFromJson,d);var f=a.getFieldTree(b),g={};d.clearOthers&&a.clear(b),d.resetOthers&&a.reset(b),e(f,c)}},a.reset=function reset(b){function c(b){for(var h in b){var j=b[h];if("nested"===j.type){c(j.tree);continue}if("radio"===j.type){for(var k,l=0;l<j.inputs.length;l++)k=j.inputs[l],k.checked=k.defaultChecked;continue}if(!(j.inputType&&-1<a.buttonInputTypes.indexOf(j.inputType))){var d=j.input;if(-1<a.checkedInputTypes.indexOf(j.inputType))d.checked=d.defaultChecked;else if(d instanceof HTMLSelectElement)for(var e,f=d.querySelectorAll("option"),g=0;g<f.length;g++)e=f[g],e.selected=e.defaultSelected;else d.getAttribute("value")?d.value=d.getAttribute("value"):("string"==typeof d.defaultValue||"number"==typeof d.defaultValue)&&(d.value=d.defaultValue)}}}var d=a.getFieldTree(b);c(d)},a.clear=function clear(b){function c(b){for(var d in b){var e=b[d];if("nested"===e.type){c(e.tree);continue}e.input&&-1<a.buttonInputTypes.indexOf(e.inputType)||a.setInputValue(e,null)}}var d=a.getFieldTree(b);c(d)},a.setInputValue=function setInputValue(b,c,d){var e=d?function(a){var b=null;"function"==typeof Event?b=new Event("change",{bubbles:!0}):(b=document.createEvent("Event"),b.initEvent("change",!0,!0)),a.dispatchEvent(b)}:null;if("radio"===b.type){for(var f,g=[],h=0;h<b.inputs.length;h++)if(f=b.inputs[h],f.checked&&g.push(f),f.checked=!1,null!==c&&a.stringify(f.value)===a.stringify(c)){f.checked||g.push(f),f.checked=!0;break}if(e)for(var p in g)e(g[p]);return}var k=b.input,l=b.inputType;if("file"!==l){var m=!1;if("checkbox"===l)c=!0===c||null!==c&&a.stringify(k.value)===a.stringify(c),c!==k.checked&&(m=!0),k.checked=c;else if(k instanceof HTMLSelectElement){var q=c;null===q||void 0===q?q=[]:a.isObject(q)?q=Object.values(q):!a.isArray(q)&&(q=[q]);for(var r=0;r<k.options.length;r++){var n=k.options[r],o=("undefined"==typeof n.value?n.text:n.value).toString();!1!==n.selected&&(m=!0),n.selected=!1;for(var s=0;s<q.length;s++)if(o===a.stringify(q[s])){!0!==n.selected&&(m=!0),n.selected=!0;break}}}else k.value!==c&&(m=!0),k.value=c;m&&e&&e(k)}},a.stringify=function stringify(a){return void 0===a?"":"object"==typeof a?"":"boolean"==typeof a?a?"1":"0":a+""},a.getFieldTree=function getFieldTree(b,c){if(b=a.getElement(b),!b)return[];for(var d,e=b.querySelectorAll("select, textarea, input, button"),f={},g={},h=0;h<e.length;h++)if(d=e[h],d.name&&0!==d.name.length&&!(c&&!0!==c(d))){var k=(d.type||"text").toLowerCase(),l=d.name,m=d.name.replace(/\]/g,"").split("[");"[]"===l.substr(-2)&&(d instanceof HTMLSelectElement&&d.multiple?m.pop():"radio"===k&&m.pop());for(var n=m.length,o=f,p="",q=0;q<n;q++){var r=m[q],s=p?p+"["+r+"]":r;""===r&&("undefined"==typeof g[s]&&(g[s]=0),r=g[s].toString(),g[s]++),p=p?p+"["+r+"]":r,n-1==q?"radio"===(d.type||"text").toLowerCase()?("undefined"==typeof o[r]&&(o[r]={type:"radio",name:d.name,inputType:k,inputs:[]}),o[r].inputs.push(d)):o[r]={type:"default",name:d.name,inputType:k,input:d}:(("undefined"==typeof o[r]||"undefined"==typeof o[r].tree)&&(o[r]={type:"nested",tree:{}}),o=o[r].tree)}}return f},a.isObject=function isObject(a){return a&&"object"==typeof a&&"[object Array]"!==Object.prototype.toString.call(a)},a.isArray=function isArray(a){return Array.isArray(a)},a.getElement=function getElement(a){return"string"==typeof a?document.querySelector(a):a instanceof HTMLElement?a:"undefined"!=typeof jQuery&&a instanceof jQuery?a[0]:"undefined"!=typeof $&&a instanceof $?a[0]:(console.warn("FormDataJson: Unsupported element passed. Supported is HTMLElement, a string query selector, JQuery or $ object"),null)},a.merge=function merge(d,a){var b={};for(var c in d)b[c]=d[c];for(var e in a)b[e]=a[e];return b},a}();FormDataJson.defaultOptionsToJson={includeDisabled:!1,includeButtonValues:!1,uncheckedValue:void 0,inputFilter:null,flatList:!1,skipEmpty:!1,filesCallback:null,fileReaderFunction:"readAsDataURL",arrayify:!0},FormDataJson.defaultOptionsFromJson={flatList:!1,clearOthers:!1,resetOthers:!1,triggerChangeEvent:!1},FormDataJson.buttonInputTypes=["button","submit","reset","image"],FormDataJson.checkedInputTypes=["checkbox","radio"],"undefined"!=typeof module&&module.exports&&(module.exports=FormDataJson);