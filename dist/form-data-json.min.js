'use strict';
// form-data-json-convert | version: 2.0.2beta | url: https://github.com/brainfoolong/form-data-json
var FormDataJson=function(){function a(){}return a.toJson=function toJson(b,c){function d(b){if("function"==typeof c.inputFilter&&!0!==c.inputFilter(b))return!1;if(!c.includeDisabled&&b.disabled)return!1;var d=(b.type||"text").toLowerCase();return!(!c.includeButtonValues&&(b instanceof HTMLButtonElement||-1<a.buttonInputTypes.indexOf(d)))&&("undefined"!=typeof c.uncheckedValue||!(-1<a.checkedInputTypes.indexOf(d))||b.checked)}function e(b,d){for(var o in b){var f=b[o],g=c.flatList?f.name:o;if("nested"===f.type){c.flatList?e(f.tree,d):(d[o]={},e(f.tree,d[o]));continue}var j=f.input,k=f.inputType;if("file"===k){c.filesCallback&&h.push({object:d,key:g,input:j});continue}var p=null;if("radio"===f.type){for(var q,r=0;r<f.inputs.length;r++)if(q=f.inputs[r],q.checked){p=q.value;break}null===p&&(p=c.uncheckedValue)}else if("checkbox"===k)p=j.checked?j.value:c.uncheckedValue;else if(j instanceof HTMLSelectElement){for(var l,m=[],n=0;n<j.options.length;n++)l=j.options[n],l.selected&&m.push(("undefined"==typeof l.value?l.text:l.value).toString());p=j.multiple?m:m.length?m[0]:null}else if(p=j.value,c.skipEmpty&&""===a.stringify(p))continue;d[g]=p}}c=a.merge(a.defaultOptionsToJson,c);var f=a.getFieldTree(b,d),g={},h=[];return e(f,g),h.length?function(){for(var b=0,d=0,e=function(e){var f=h[e],i=f.object;d+=f.input.files.length;for(var k=function(e){var h=f.input.files[e],j=new FileReader;j.onload=function(){f.input.multiple?(!a.isArray(i[f.key])&&(i[f.key]=[]),i[f.key].push(j.result)):i[f.key]=j.result,b++,b===d&&c.filesCallback(a.arrayfy(g))},j[c.fileReaderFunction](h)},l=0;l<f.input.files.length;l++)k(l)},f=0;f<h.length;f++)e(f)}():c.filesCallback&&c.filesCallback(a.arrayfy(g)),a.arrayfy(g)},a.fromJson=function fromJson(b,c,d){function e(b,c){for(var h in b){var f=b[h],g=d.flatList?f.name:h;if("nested"===f.type){d.flatList?e(f.tree,c):"object"==typeof c[g]&&e(f.tree,c[g]);continue}(d.clearOthers||"undefined"!=typeof c[g])&&a.setInputValue(f,c[g]||null,d.triggerChangeEvent)}}if(a.isObject(c)){d=a.merge(a.defaultOptionsFromJson,d);var f=a.getFieldTree(b);d.clearOthers&&a.clear(b),e(f,c)}},a.reset=function reset(b){function c(b){for(var h in b){var j=b[h];if("nested"===j.type){c(j.tree);continue}if("radio"===j.type){for(var k,l=0;l<j.inputs.length;l++)k=j.inputs[l],k.checked=k.defaultChecked;continue}if(!(j.inputType&&-1<a.buttonInputTypes.indexOf(j.inputType))){var d=j.input;if(-1<a.checkedInputTypes.indexOf(j.inputType))d.checked=d.defaultChecked;else if(d instanceof HTMLSelectElement)for(var e,f=d.querySelectorAll("option"),g=0;g<f.length;g++)e=f[g],e.selected=e.defaultSelected;else d.getAttribute("value")?d.value=d.getAttribute("value"):("string"==typeof d.defaultValue||"number"==typeof d.defaultValue)&&(d.value=d.defaultValue)}}}var d=a.getFieldTree(b);c(d)},a.clear=function clear(b){function c(b){for(var d in b){var e=b[d];if("nested"===e.type){c(e.tree);continue}e.input&&-1<a.buttonInputTypes.indexOf(e.inputType)||a.setInputValue(e,null)}}var d=a.getFieldTree(b);c(d)},a.arrayfy=function arrayfy(b){if(a.isObject(b)){var c=0,d=!0;for(var e in b)a.isObject(b[e])&&!(b[e]instanceof Element)&&(b[e]=a.arrayfy(b[e])),parseInt(e)!==c&&(d=!1),c++;if(d){var f=[];for(var g in b)f.push(b[g]);return f}}return b},a.setInputValue=function setInputValue(b,c,d){var e=d?function(a){var b=null;"function"==typeof Event?b=new Event("change",{bubbles:!0}):(b=document.createEvent("Event"),b.initEvent("change",!0,!0)),a.dispatchEvent(b)}:null;if("radio"===b.type){for(var f,g=[],h=0;h<b.inputs.length;h++)if(f=b.inputs[h],f.checked&&g.push(f),f.checked=!1,null!==c&&a.stringify(f.value)===a.stringify(c)){f.checked||g.push(f),f.checked=!0;break}if(e)for(var p in g)e(g[p]);return}var k=b.input,l=b.inputType;if("file"!==l){var m=!1;if("checkbox"===l)c=!0===c||null!==c&&a.stringify(k.value)===a.stringify(c),c!==k.checked&&(m=!0),k.checked=c;else if(k instanceof HTMLSelectElement){var q=c;null===q||void 0===q?q=[]:a.isObject(q)?q=Object.values(q):!a.isArray(q)&&(q=[q]);for(var r=0;r<k.options.length;r++){var n=k.options[r],o=("undefined"==typeof n.value?n.text:n.value).toString();!1!==n.selected&&(m=!0),n.selected=!1;for(var s=0;s<q.length;s++)if(o===a.stringify(q[s])){!0!==n.selected&&(m=!0),n.selected=!0;break}}}else k.value!==c&&(m=!0),k.value=c;m&&e&&e(k)}},a.stringify=function stringify(a){return void 0===a?"":"object"==typeof a?"":"boolean"==typeof a?a?"1":"0":a+""},a.getFieldTree=function getFieldTree(b,c){if(b=a.getElement(b),!b)return[];for(var d,e=b.querySelectorAll("select, textarea, input, button"),f={},g={},h=0;h<e.length;h++)if(d=e[h],d.name&&0!==d.name.length&&!(c&&!0!==c(d))){var k=(d.type||"text").toLowerCase(),l=d.name,m=d.name.replace(/\]/g,"").split("[");"[]"===l.substr(-2)&&(d instanceof HTMLSelectElement&&d.multiple?m.pop():"radio"===k&&m.pop());for(var n,o=m.length,p=f,q="",r=0;r<o;r++)n=m[r],q=q?q+"["+n+"]":n,""===n&&("undefined"==typeof g[q]&&(g[q]=0),n=g[q].toString(),g[q]++),o-1==r?"radio"===(d.type||"text").toLowerCase()?("undefined"==typeof p[n]&&(p[n]={type:"radio",name:d.name,inputType:k,inputs:[]}),p[n].inputs.push(d)):p[n]={type:"default",name:d.name,inputType:k,input:d}:(("undefined"==typeof p[n]||"undefined"==typeof p[n].tree)&&(p[n]={type:"nested",tree:{}}),p=p[n].tree)}return f},a.isObject=function isObject(a){return a&&"object"==typeof a&&"[object Array]"!==Object.prototype.toString.call(a)},a.isArray=function isArray(a){return"object"==typeof a&&"[object Array]"===Object.prototype.toString.call(a)},a.getElement=function getElement(a){return"string"==typeof a?document.querySelector(a):a instanceof HTMLElement?a:"undefined"!=typeof jQuery&&a instanceof jQuery?a[0]:(console.warn("FormDataJson: Unsupported element passed. Supported is HTMLElement, a string query selector or JQuery object"),null)},a.merge=function merge(d,a){var b={};for(var c in d)b[c]=d[c];for(var e in a)b[e]=a[e];return b},a}();FormDataJson.defaultOptionsToJson={includeDisabled:!1,includeButtonValues:!1,uncheckedValue:void 0,inputFilter:null,flatList:!1,skipEmpty:!1,filesCallback:null,fileReaderFunction:"readAsDataURL"},FormDataJson.defaultOptionsFromJson={flatList:!1,clearOthers:!1,triggerChangeEvent:!1},FormDataJson.buttonInputTypes=["button","submit","reset","image"],FormDataJson.checkedInputTypes=["checkbox","radio"],"undefined"!=typeof module&&module.exports&&(module.exports=FormDataJson);